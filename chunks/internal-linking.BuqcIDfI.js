import{w as withErrorHandling}from"./posts.DE2cufBC.js";import"./_astro_content.C3X8YU77.js";function topN(e,t,n){return[...e].sort(((e,t)=>n(t)-n(e))).slice(0,t)}function unique(e){return[...new Set(e)]}const SCORING_WEIGHTS={"exact-keyword":10,"partial-keyword":6,category:5,tag:4,cluster:3,author:1};class LinkScorer{weights;constructor(e){this.weights={...SCORING_WEIGHTS,...e}}scoreMatch(e,t=1){return(this.weights[e]||0)*t}calculateTotalScore(e){return e.reduce(((e,t)=>{const n=t.count??1;return e+this.scoreMatch(t.type,n)}),0)}prioritize(e,t,n){const r=[...e].sort(((e,n)=>t(n)-t(e)));return n?r.slice(0,n):r}getLinkingContext(e){return e>=15?"strong":e>=8?"moderate":"weak"}}new LinkScorer;const TOPIC_CLUSTERS={"mentale-gesundheit":{name:"Mentale Gesundheit & Psyche",keywords:["depression","angst","stress","mental","psyche","gefühle","emotionen","resilienz","achtsamkeit","meditation"],pillarPost:"2024-10-18-17-mentale-blockaden-die-erfolg-verhindern",supportingCategories:["Mentale Gesundheit","Persönlichkeitsentwicklung","Stressbewältigung"]},"ernaehrung-nahrungsergaenzung":{name:"Ernährung & Nahrungsergänzung",keywords:["ernährung","nahrung","lebensmittel","superfood","antioxidantien","entzündung","diet","kalorien"],pillarPost:"2025-05-06-top-entzuendungshemmende-lebensmittel",supportingCategories:["Ernährung","Superfoods","Nahrungsergänzung"]},"immunsystem-gesundheit":{name:"Immunsystem & Gesundheit",keywords:["immunsystem","immunität","antiviral","infektion","abwehr","widerstand","gesundheit"],pillarPost:"2023-08-14-top-lebensmittel-fuers-immunsystems",supportingCategories:["Immunsystem","Gesundheitsvorsorge","Prävention"]},"darm-mikrobiom":{name:"Darm & Mikrobiom",keywords:["darm","mikrobiom","probiotika","verdauung","bakterien","stuhlgang","magen"],pillarPost:"2024-10-29-die-wissenschaft-der-darm-hirn-achse",supportingCategories:["Darmgesundheit","Verdauung","Mikrobiom"]},"vitamine-mineralstoffe":{name:"Vitamine & Mineralstoffe",keywords:["vitamin","mineral","nährstoff","mangel","defizit","supplementierung","b12","vitamin-d","vitamin-c"],pillarPost:"2025-02-10-18-warnzeichen-fuer-naehrstoffmangel",supportingCategories:["Mikronährstoffe","Vitamine","Mineralien"]}},linkScorer=new LinkScorer({"exact-keyword":10,"partial-keyword":6,category:5,tag:4,cluster:3,author:1}),RECENCY_BONUS=2;function analyzeContentRelationships(e,t,n=5){return withErrorHandling((()=>{const r=[],s=t.filter((t=>t?.id&&e?.id&&t.id!==e.id));for(const t of s){const n=calculateContentRelationship(e,t);n.score>0&&r.push(n)}return topN(r,n,(e=>e.score))}),"analyzeContentRelationships",[])}function calculateContentRelationship(e,t){return withErrorHandling((()=>{let n=0;const r=[],s=[],i=(e.data.title.toLowerCase(),t.data.title.toLowerCase()),o=e.data.categories??[],a=t.data.categories??[],u=e.data.tags??[],c=t.data.tags??[],l=e.data.keywords??[],h=t.data.keywords??[];for(const e of l){const t=e.toLowerCase();h.some((e=>e.toLowerCase()===t))||i.includes(t)?(n+=linkScorer.scoreMatch("exact-keyword"),r.push(`Exact keyword match: ${e}`),s.push(e)):(i.includes(t.split(" ")[0])||h.some((e=>e.toLowerCase().includes(t.split(" ")[0]))))&&(n+=linkScorer.scoreMatch("partial-keyword"),r.push(`Partial keyword match: ${e}`))}const g=o.filter((e=>a.includes(e)));g.length>0&&(n+=linkScorer.scoreMatch("category",g.length),r.push(`Shared categories: ${g.join(", ")}`),g.forEach((e=>{s.push(getCategoryAnchorText(e))})));const d=u.filter((e=>c.includes(e)));d.length>0&&(n+=linkScorer.scoreMatch("tag",d.length),r.push(`Shared tags: ${d.join(", ")}`));const m=identifyTopicCluster(e),p=identifyTopicCluster(t);m&&p&&m===p&&(n+=linkScorer.scoreMatch("cluster"),r.push(`Same topic cluster: ${TOPIC_CLUSTERS[m].name}`)),m&&p&&areRelatedClusters(m,p)&&(n+=linkScorer.scoreMatch("cluster")/2,r.push("Related topic clusters")),e.data.author===t.data.author&&(n+=linkScorer.scoreMatch("author"),r.push("Same author"));const w=new Date(t.data.pubDatetime),f=new Date;f.setFullYear(f.getFullYear()-1),w>f&&(n+=2,r.push("Recent content")),0===s.length&&s.push(...generateSmartAnchorText(t));const k=linkScorer.getLinkingContext(n);return{targetPost:t,score:n,matchReasons:r,suggestedAnchorText:unique(s),linkingContext:k}}),"calculateContentRelationship",{targetPost:t,score:0,matchReasons:[],suggestedAnchorText:[],linkingContext:"weak"})}function identifyTopicCluster(e){const t=e.data.title.toLowerCase(),n=(e.data.categories??[]).map((e=>e.toLowerCase())),r=(e.data.keywords??[]).map((e=>e.toLowerCase())),s=[t,...n,...r].join(" ");let i=null;for(const[e,t]of Object.entries(TOPIC_CLUSTERS)){let r=0;for(const e of t.keywords)s.includes(e)&&(r+=1);for(const e of t.supportingCategories)n.includes(e.toLowerCase())&&(r+=2);r>0&&(!i||r>i.score)&&(i={cluster:e,score:r})}return i?.cluster||null}function areRelatedClusters(e,t){return[["darm-mikrobiom","mentale-gesundheit"],["darm-mikrobiom","immunsystem-gesundheit"],["vitamine-mineralstoffe","mentale-gesundheit"],["vitamine-mineralstoffe","immunsystem-gesundheit"],["ernaehrung-nahrungsergaenzung","immunsystem-gesundheit"],["ernaehrung-nahrungsergaenzung","vitamine-mineralstoffe"]].some((([n,r])=>e===n&&t===r||e===r&&t===n))}function generateSmartAnchorText(e){const t=e.data.title,n=e.data.keywords??[],r=[];n.slice(0,3).forEach((e=>{r.push(e)}));const s=t.split(" ");if(s.length>=3){const e=s.slice(0,4).join(" ");r.push(e)}return(t.toLowerCase().includes("warnzeichen")||t.toLowerCase().includes("symptome"))&&r.push("Warnzeichen erkennen","Symptome verstehen"),(t.toLowerCase().includes("tipps")||t.toLowerCase().includes("strategien"))&&r.push("praktische Tipps","bewährte Strategien"),(t.toLowerCase().includes("gesunde")||t.toLowerCase().includes("gesundheit"))&&r.push("gesunde Ansätze","Gesundheit verbessern"),r.slice(0,5)}function getCategoryAnchorText(e){return{"Mentale Gesundheit":"mentale Gesundheit stärken","Ernährung":"gesunde Ernährung",Immunsystem:"Immunsystem stärken",Darmgesundheit:"Darmgesundheit verbessern","Mikronährstoffe":"wichtige Nährstoffe",Vitamine:"essentielle Vitamine","Stressbewältigung":"Stress bewältigen","Persönlichkeitsentwicklung":"persönlich wachsen"}[e]||e.toLowerCase()}export{TOPIC_CLUSTERS as T,analyzeContentRelationships as a,identifyTopicCluster as i};