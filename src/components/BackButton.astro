---
/**
 * Back Button Component
 *
 * Displays a back navigation button that intelligently returns users
 * to their previous page using sessionStorage state management.
 *
 * Features:
 * - Restores previous URL from sessionStorage
 * - Falls back to home page if no previous URL exists
 * - Supports Astro view transitions
 * - Conditionally rendered based on SITE.showBackButton config
 *
 * @component
 */
import IconChevronLeft from "@/assets/icons/IconChevronLeft.svg";
import { SITE } from "@/config";

import LinkButton from "./elements/LinkButton.astro";
---

{
  SITE.showBackButton && (
    <div class="mx-auto flex w-full max-w-content items-center justify-start px-2">
      <LinkButton
        id="back-button"
        href="/"
        class="focus-outline mt-8 mb-2 flex hover:text-foreground/75"
      >
        <IconChevronLeft class="inline-block size-6" />
        <span>Go back</span>
      </LinkButton>
    </div>
  )
}

<script>
  /**
   * Updates the back button URL from sessionStorage
   *
   * Retrieves the previous page URL stored in sessionStorage
   * and updates the back button's href attribute accordingly.
   * Falls back to default href (home page) if no URL is stored.
   */
  function updateGoBackUrl() {
    const backButton: HTMLAnchorElement | null =
      document.querySelector("#back-button");

    const backUrl = sessionStorage.getItem("backUrl");

    if (backUrl && backButton) {
      backButton.href = backUrl;
    }
  }

  document.addEventListener("astro:page-load", updateGoBackUrl);
  updateGoBackUrl();
</script>
