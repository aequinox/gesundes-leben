---
/**
 * Headline Component
 *
 * A versatile component for displaying section headlines with optional
 * subtitle and tagline. Supports customizable styling and accessibility features.
 *
 * @component
 * @example
 * ```astro
 * <Headline
 *   title="Main Title"
 *   subtitle="Optional subtitle"
 *   tagline="Optional tagline"
 *   classes={{
 *     container: "max-w-3xl",
 *     title: "text-3xl",
 *     subtitle: "text-xl"
 *   }}
 * />
 * ```
 */

interface Props {
  /** Main title text */
  title?: string | Promise<string>;
  /** Secondary subtitle text */
  subtitle?: string | Promise<string>;
  /** Small text above the title */
  tagline?: string | Promise<string>;
  /** CSS classes for styling different parts */
  classes?: {
    /** Classes for the container element */
    container?: string;
    /** Classes for the title element */
    title?: string;
    /** Classes for the subtitle element */
    subtitle?: string;
  };
}

const {
  title = await Astro.slots.render("title"),
  subtitle = await Astro.slots.render("subtitle"),
  tagline = await Astro.slots.render("tagline"),
  classes = {},
}: Props = Astro.props;

// Memoize common class names
const containerClasses = [
  "not-prose mb-8 text-center",
  "md:mx-auto md:mb-12",
  classes.container || "max-w-3xl",
]
  .filter(Boolean)
  .join(" ");

const titleClasses = [
  "font-heading text-heading",
  "text-2xl font-semibold",
  "leading-tighter tracking-tighter",
  "text-skin-base",
  classes.title || "text-3xl md:text-4xl",
]
  .filter(Boolean)
  .join(" ");

const subtitleClasses = ["mt-4", classes.subtitle || "text-skin-muted text-xl"]
  .filter(Boolean)
  .join(" ");

const taglineClasses = [
  "text-base font-semibold",
  "uppercase tracking-wider",
  "text-skin-muted",
].join(" ");

// Generate unique IDs for accessibility
const headlineId = `headline-${Math.random().toString(36).substring(2, 9)}`;
const subtitleId = subtitle
  ? `subtitle-${Math.random().toString(36).substring(2, 9)}`
  : undefined;
---

{
  (title || subtitle || tagline) && (
    <div class={containerClasses} role="region" aria-labelledby={headlineId}>
      {tagline && <p class={taglineClasses} set:html={tagline} />}

      {title && <h2 id={headlineId} class={titleClasses} set:html={title} />}

      {subtitle && (
        <p
          id={subtitleId}
          class={subtitleClasses}
          set:html={subtitle}
          aria-labelledby={`${headlineId} ${subtitleId}`}
        />
      )}
    </div>
  )
}

<style>
  /* Base styles */
  div {
    @apply transition-colors duration-300;
  }

  /* Focus styles */
  div:focus-within {
    @apply ring-2 ring-skin-accent ring-offset-2;
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    div {
      @apply transition-none;
    }
  }

  /* Print styles */
  @media print {
    div {
      @apply break-inside-avoid text-black;
    }
  }

  /* High contrast mode */
  @media (forced-colors: active) {
    div {
      @apply border border-[CanvasText];
    }

    h2 {
      @apply text-[Heading];
    }
  }

  /* Dark mode adjustments */
  :global(.dark) div {
    @apply text-skin-base;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    h2 {
      @apply text-2xl;
    }

    p {
      @apply text-base;
    }
  }
</style>
