---
/**
 * Authors Index Page
 *
 * Displays all authors with their bio and links to their posts.
 * Refactored to fix double-layout bug and use ListingPageLayout.
 */

import { Icon } from "astro-icon/components";

import { getLangFromUrl, useTranslations } from "@/i18n/utils";
import ListingPageLayout from "@/layouts/ListingPageLayout.astro";
import { getAllAuthors } from "@/utils/authors";

const authors = await getAllAuthors();

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// Page title and description
const pageTitle = t("nav.authors");
const pageDescription = t("post.allAuthors");
---

<ListingPageLayout
  title={pageTitle}
  pageTitle={pageTitle}
  pageDescription={pageDescription}
  activeNav="authors"
>
  <section class="mx-auto prose max-w-3xl">
    <ul class="grid gap-4 sm:grid-cols-2">
      {
        authors.map(author => (
          <li class="flex items-center rounded-lg border border-line p-4 shadow-sm transition-all hover:shadow-md">
            <a
              href={`/author/${author.id.replace(/\.(md|mdx)$/, "")}`}
              class="flex w-full items-center gap-4"
            >
              <div class="flex h-12 w-12 items-center justify-center rounded-full bg-accent/10 text-accent">
                <Icon name="tabler:user" class="h-6 w-6" />
              </div>
              <div>
                <h2 class="text-lg font-medium">{author.data.name}</h2>
                {author.data.bio && (
                  <p class="line-clamp-2 text-sm opacity-80">
                    {author.data.bio}
                  </p>
                )}
              </div>
            </a>
          </li>
        ))
      }
    </ul>
  </section>
</ListingPageLayout>
