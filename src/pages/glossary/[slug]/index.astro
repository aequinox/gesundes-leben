---
import { type CollectionEntry, getCollection } from "astro:content";
import Glossary from "@/layouts/Glossary.astro";
// import PostDetails from "@layouts/PostDetails.astro";
import getPageNumbers from "@/utils/getPageNumbers";
import getPagination from "@/utils/getPagination";

export interface Props {
  post: CollectionEntry<"glossary">;
}

export async function getStaticPaths() {
  const posts: CollectionEntry<"glossary">[] = await getCollection("glossary");

  const postResult = posts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));

  const pagePaths = getPageNumbers(posts.length).map(pageNum => ({
    params: { slug: String(pageNum) },
  }));

  return [...postResult, ...pagePaths];
}

const { slug } = Astro.params;
// const { post } = Astro.props;

const posts: CollectionEntry<"glossary">[] = await getCollection("glossary");

const sortedPosts = posts.sort((a, b) =>
  a.data.title.localeCompare(b.data.title)
);

const pagination = getPagination({
  posts: sortedPosts,
  page: slug,
});
---

<Glossary {...pagination} />
<!-- {post ? <PostDetails post={post} /> : <Glossary {...pagination} />} -->
